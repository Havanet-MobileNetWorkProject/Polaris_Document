\documentclass{report}
\usepackage{ptext}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{ptext}

\input{Boostan-UserManual}

\input{Chapters/BWords}
\input{Chapters/abbre}

\title{گزارش پروژه نهایی درس شبکه های تلفن همراه}
\type{گزارش }
\author{زهرا دهقان\\اسماء حمید\\فاطمه شرح دهی مقدم}

\logofile{Pic/logo}


\begin{document}

\pagenumbering{gobble}
\Godpage
\maketitle
\pagenumbering{arabic}
\tableofcontents


\chapter{مقدمه}








\chapter{ \lr{Polaris Server}}

\section{Authentication}

\subsection{\lr{Register API} (ثبت‌نام کاربر)}
\textbf{مدل (User Model)} \\
مدل کاربر برای سامانه Polaris به شکل زیر طراحی شده است:

\begin{itemize}
  \item \lr{phone}: شماره تلفن کاربر (یونیک و به‌عنوان نام کاربری استفاده می‌شود).
  \item \lr{role}: نقش کاربر که می‌تواند \lr{user} یا \lr{admin} باشد (پیش‌فرض: \lr{user}).
  \item \lr{is\_active}: تعیین فعال بودن کاربر.
  \item \lr{is\_staff}: برای تشخیص دسترسی مدیریتی.
\end{itemize}

کاربران عادی نقش \lr{user} دارند و مدیران (\lr{superuser}) نقش \lr{admin}. \\
همچنین یک \lr{UserManager} پیاده‌سازی شده تا:
\begin{itemize}
  \item تابع \lr{create\_user}: کاربر عادی بسازد.
  \item تابع \lr{create\_superuser}: ادمین بسازد.
\end{itemize}
\begin{lstlisting}[language=python]
class UserManager(BaseUserManager):
    def create_user(self, phone, password=None, **extra_fields):
        if not phone:
            raise ValueError("Phone number is required")
        user = self.model(phone=phone, **extra_fields)
        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_superuser(self, phone, password=None, **extra_fields):
        extra_fields.setdefault('is_staff', True)
        extra_fields.setdefault('is_superuser', True)
        extra_fields.setdefault('role', 'admin')
        return self.create_user(phone, password, **extra_fields)

class User(AbstractBaseUser, PermissionsMixin):
    ROLE_CHOICES = (
        ('user', 'User'),
        ('admin', 'Admin'),
    )

    phone = models.CharField(max_length=15, unique=True)
    role = models.CharField(max_length=10, choices=ROLE_CHOICES, default='user')
    is_active = models.BooleanField(default=True)
    is_staff = models.BooleanField(default=False)

    objects = UserManager()

    USERNAME_FIELD = 'phone'
    REQUIRED_FIELDS = []

    def __str__(self):
        return self.phone

\end{lstlisting}
\textbf{Serializer (RegisterSerializer)} \\
کلاس \lr{RegisterSerializer} برای اعتبارسنجی داده‌های ورودی ثبت‌نام استفاده می‌شود:
\begin{itemize}
  \item فقط دو فیلد دریافت می‌کند: \lr{phone} و \lr{password}.
  \item \lr{password} فقط نوشتنی (\lr{write\_only}) است.
  \item تابع \lr{create}: از متد \lr{create\_user} در \lr{UserManager} استفاده می‌کند.
\end{itemize}

\textbf{View (RegisterView)} \\
کلاس \lr{RegisterView} یک \lr{APIView} است که درخواست‌های POST را پردازش می‌کند:
\begin{itemize}
  \item داده‌های ورودی توسط \lr{RegisterSerializer} بررسی می‌شود.
  \item اگر معتبر بود: کاربر ساخته می‌شود و توکن‌های JWT صادر می‌گردد.
  \item خروجی شامل توکن‌ها + اطلاعات کاربر است.
\end{itemize}

\textbf{ورودی (POST /auth/signup/)}:
\begin{lstlisting}[language=json]
{
  "phone": "09123456789",
  "password": "test1234"
}
\end{lstlisting}

\textbf{خروجی موفق (201)}:
\begin{lstlisting}[language=json]
{
  "refresh": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1...",
  "access": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1...",
  "user": {
    "id": 1,
    "phone": "09123456789",
    "role": "user"
  }
}
\end{lstlisting}

\textbf{خروجی ناموفق (400)}:
\begin{lstlisting}[language=json]
{
  "phone": ["This field must be unique."]
}
\end{lstlisting}
\subsubsection{Post-Save Signal (ایجاد آستانه‌های پیش‌فرض بعد از ثبت‌نام)}

پس از ثبت‌نام هر کاربر جدید، یک سیگنال \lr{post\_save} در جنگو اجرا می‌شود. این سیگنال باعث می‌شود که به‌طور خودکار مجموعه‌ای از \lr{ThresholdParameter} و \lr{ThresholdLevel} برای کاربر ایجاد گردد.

\textbf{کلیت Threshold} \\
جزئیات کامل ساختار و کاربرد \lr{Threshold}ها در فصل مربوط به Thresholds توضیح داده خواهد شد. 
در این بخش تنها نحوه‌ی ایجاد پیش‌فرض‌ها هنگام ثبت‌نام بیان می‌شود.

\textbf{Signal (create\_default\_thresholds)} \\
این تابع سیگنال پس از ذخیره‌ی یک کاربر (\lr{User}) اجرا می‌شود:
\begin{itemize}
  \item بررسی می‌کند که آیا کاربر تازه ساخته شده است و نقش او \lr{user} باشد.
  \item اگر درست باشد، بر اساس \lr{default\_thresholds} برای هر فناوری (\lr{2G}, \lr{3G}, \lr{4G}, \lr{5G}) پارامترها ساخته می‌شوند.
  \item برای هر پارامتر چندین سطح (\lr{ThresholdLevel}) با بازه مقادیر و رنگ مشخص ایجاد می‌شود.
\end{itemize}

\textbf{کد سیگنال (نمونه)}:
\begin{lstlisting}[language=python]
@receiver(post_save, sender=User)
def create_default_thresholds(sender, instance, created, **kwargs):
    if created and instance.role == "user":
        for tech, params in default_thresholds.items():
            for p in params:
                param = ThresholdParameter.objects.create(
                    user=instance,
                    name=p["name"],
                    technology=tech,
                    signal_type=p["signal_type"],
                )
                for lvl in p["levels"]:
                    ThresholdLevel.objects.create(
                        parameter=param,
                        level=lvl["level"],
                        color=lvl["color"],
                        min_value=lvl["min"],
                        max_value=lvl["max"],
                    )
\end{lstlisting}

\textbf{مقادیر پیش‌فرض (\lr{default\_thresholds})} \\
این مقادیر برای هر فناوری از قبل تعریف شده‌اند.

\textbf{نمونه برای 2G}:
\begin{lstlisting}[language=json]
"2G": [
  {
    "name": "rxlev",
    "signal_type": "quantity",
    "levels": [
      {"level": 1, "color": "#FF0000", "min": -110, "max": -100},
      {"level": 2, "color": "#FFFF00", "min": -100, "max": -80},
      {"level": 3, "color": "#008000", "min": -80, "max": -50}
    ]
  }
]
\end{lstlisting}

برای سایر فناوری‌ها (\lr{3G}، \lr{4G}، \lr{5G}) نیز پارامترهایی مانند \lr{rscp}، \lr{rsrp} و \lr{rsrq} تعریف شده‌اند که هرکدام دارای سطوح رنگی مختلف هستند. 

به این ترتیب، هر کاربر جدید بلافاصله پس از ثبت‌نام، یک مجموعه‌ی اولیه از آستانه‌های سنجش کیفیت و کمیت سیگنال را در اختیار خواهد داشت.



\subsection{Login API (ورود کاربر)}
\textbf{View (LoginView)} \\
\begin{itemize}
  \item درخواست POST می‌گیرد.
  \item شماره تلفن و رمز عبور را بررسی می‌کند.
  \item در صورت معتبر بودن، توکن‌های JWT صادر می‌کند.
  \item اطلاعات کاربر بازگردانده می‌شود.
\end{itemize}

\textbf{ورودی (POST /auth/login/)}:
\begin{lstlisting}[language=json]
{
  "phone": "09123456789",
  "password": "test1234"
}
\end{lstlisting}

\textbf{خروجی موفق (200)}:
\begin{lstlisting}[language=json]
{
  "refresh": "eyJ0eXAiOiJKV1QiLCJh...",
  "access": "eyJ0eXAiOiJKV1QiLCJh...",
  "user": {
    "id": 1,
    "phone": "09123456789",
    "role": "user"
  }
}
\end{lstlisting}

\textbf{خروجی ناموفق (401)}:
\begin{lstlisting}[language=json]
{
  "error": "Invalid credentials"
}
\end{lstlisting}


\subsection{Logout API (خروج کاربر)}
\textbf{View (LogoutView)} \\
\begin{itemize}
  \item درخواست POST دریافت می‌کند.
  \item کاربر باید توکن \lr{refresh} را ارسال کند.
  \item توکن بلاک‌لیست می‌شود.
\end{itemize}

\textbf{ورودی (POST /auth/logout/)}:
\begin{lstlisting}[language=json]
{
  "refresh": "eyJ0eXAiOiJKV1QiLCJh..."
}
\end{lstlisting}

\textbf{خروجی موفق (205)}: (بدون بدنه) \\
\textbf{خروجی ناموفق (400)}: (بدون بدنه)


\subsection{Profile API (نمایه کاربر)}
\textbf{Serializer (UserSerializer)} \\
برای نمایش اطلاعات کاربر از \lr{UserSerializer} استفاده می‌شود (شامل \lr{id}, \lr{phone}, \lr{role}).

\textbf{View (ProfileView)} \\
\begin{itemize}
  \item درخواست GET دریافت می‌کند.
  \item نیاز به احراز هویت دارد.
  \item اطلاعات کاربر لاگین‌شده بازگردانده می‌شود.
\end{itemize}

\textbf{ورودی (GET /auth/profile/)}: بدون بدنه (توکن در Header). \\

\textbf{خروجی موفق (200)}:
\begin{lstlisting}[language=json]
{
  "id": 1,
  "phone": "09123456789",
  "role": "user"
}
\end{lstlisting}

\textbf{خروجی ناموفق (401)}:
\begin{lstlisting}[language=json]
{
  "detail": "Authentication credentials were not provided."
}
\end{lstlisting}

\section{\lr{CellInfo API}}

\lr{CellInfo API} برای ثبت و دریافت اطلاعات سیگنال سلولی کاربران طراحی شده است. این \lr{API} انواع شبکه‌ها را پشتیبانی می‌کند: \lr{2G, 3G, 4G, 5G}. کاربران باید احراز هویت شده باشند (\lr{IsAuthenticated}) تا بتوانند داده‌ها را ارسال یا دریافت کنند.
\begin{itemize}
    \item کاربران عادی: فقط داده‌های خودشان را می‌بینند.
    \item ادمین‌ها: می‌توانند داده همه کاربران را مشاهده کنند و در صورت نیاز با پارامتر \lr{client\_id} فیلتر کنند.
    \item \lr{Pagination}: درخواست \lr{GET} شامل تعداد کل، تعداد صفحات، صفحه جاری و نتایج است.
\end{itemize}

\subsection{مدل‌ها}
تمام مدل‌ها از \lr{BaseSignalTest} ارث‌بری می‌کنند.

\subsubsection{\lr{BaseSignalTest}}
\begin{itemize}
    \item \lr{timestamp (DateTimeField)}: زمان ثبت سیگنال
    \item \lr{technology (CharField)}: نوع تکنولوژی سلولی. گزینه‌ها: \lr{'GSM'}, \lr{'GPRS'}, \lr{'EDGE'}, \lr{'UMTS'}, \lr{'HSPA'}, \lr{'HSPA+'}, \lr{'LTE'}, \lr{'LTE-Adv'}, \lr{'5G'}
    \item \lr{latitude} و \lr{longitude (FloatField)}: موقعیت جغرافیایی سیگنال
    \item \lr{plmn\_id (CharField)}: شناسه شبکه تلفن همراه
    \item \lr{cell\_id (BigIntegerField)}: شناسه سلول
    \item \lr{arfcn (IntegerField, optional)}: فرکانس رادیویی
    \item \lr{band (IntegerField, optional)}: باند فرکانسی
    \item \lr{Property generation}:
    \begin{itemize}
        \item \lr{2G → GSM, GPRS, EDGE}
        \item \lr{3G → UMTS, HSPA, HSPA+}
        \item \lr{4G → LTE, LTE-Adv}
        \item \lr{5G → 5G}
        \item \lr{Unknown →} سایر مقادیر
    \end{itemize}
\end{itemize}

\subsection{مدل‌های اختصاصی هر نسل}
\subsubsection{\lr{SignalTest2G}}
\begin{itemize}
    \item ارث‌بری از \lr{BaseSignalTest}
    \item \lr{user (ForeignKey → User)}: کاربر ثبت‌کننده
    \item \lr{lac (IntegerField)}: کد منطقه سلولی
    \item \lr{rxlev (FloatField, optional)}: قدرت سیگنال
\end{itemize}

\subsubsection{\lr{SignalTest3G}}
\begin{itemize}
    \item \lr{user (ForeignKey → User)}
    \item \lr{lac (IntegerField)}
    \item \lr{rscp (FloatField)}: قدرت سیگنال رادیویی
    \item \lr{node\_id (BigIntegerField)}: شناسه \lr{Node}
\end{itemize}

\subsubsection{\lr{SignalTest4G}}
\begin{itemize}
    \item \lr{user (ForeignKey → User)}
    \item \lr{tac (IntegerField)}: کد منطقه تکنولوژی \lr{LTE}
    \item \lr{rsrp (FloatField)}: قدرت سیگنال \lr{LTE}
    \item \lr{rsrq (FloatField, optional)}: کیفیت سیگنال \lr{LTE}
    \item \lr{node\_id (BigIntegerField)}
\end{itemize}

\subsubsection{\lr{SignalTest5G}}
\begin{itemize}
    \item مشابه \lr{4G}، شامل \lr{tac, rsrp, rsrq, node\_id}
\end{itemize}

\section{Serializerها}
\begin{itemize}
    \item \lr{SignalTest2GSerializer, SignalTest3GSerializer, SignalTest4GSerializer, SignalTest5GSerializer}
    \begin{itemize}
        \item نقش: تبدیل داده‌های مدل به \lr{JSON} و اعتبارسنجی داده‌های ورودی
        \item فیلد \lr{user} فقط خواندنی است و هنگام \lr{POST} از کاربر جاری پر می‌شود
        \item تمام فیلدهای دیگر بر اساس مدل هستند (\lr{fields = '\_\_all\_\_'})
    \end{itemize}
\end{itemize}

\section{View}
\subsection{\lr{UnifiedSignalTestView (APIView)}}
\subsubsection{\lr{POST /cellinfo/signal/}}
\begin{itemize}
    \item عملکرد: ثبت یک رکورد سیگنال جدید
    \item احراز هویت: الزامی (\lr{IsAuthenticated})
    \item ورودی: \lr{JSON} شامل فیلدهای مدل مرتبط با تکنولوژی
\end{itemize}

\paragraph{جریان اتفاقات کد در \lr{POST}}
\begin{enumerate}
    \item دریافت داده‌ها از کاربر
    \item انتخاب \lr{Serializer} مناسب بر اساس تکنولوژی
    \item اعتبارسنجی داده‌ها توسط \lr{Serializer}
    \item ذخیره داده‌ها در دیتابیس و اختصاص \lr{user} به کاربر جاری
    \item برگرداندن \lr{Response} موفق (\lr{201 Created}) یا خطا (\lr{400 Bad Request})
\end{enumerate}

\paragraph{مثال \lr{POST 4G}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "technology": "LTE",
  "timestamp": "2025-08-21T12:00:00Z",
  "latitude": 52.37,
  "longitude": 4.89,
  "plmn_id": "12345",
  "cell_id": 67890,
  "tac": 101,
  "rsrp": -85.0,
  "rsrq": -10.0,
  "node_id": 5555
}
\end{lstlisting}
\end{latin}

\paragraph{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "id": 1,
  "user": 2,
  "technology": "LTE",
  "timestamp": "2025-08-21T12:00:00Z",
  "latitude": 52.37,
  "longitude": 4.89,
  "plmn_id": "12345",
  "cell_id": 67890,
  "tac": 101,
  "rsrp": -85.0,
  "rsrq": -10.0,
  "node_id": 5555
}
\end{lstlisting}
\end{latin}

\paragraph{\lr{Response Fail 400}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{"error": "Invalid or missing technology field"}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{GET /cellinfo/signal/}}
\begin{itemize}
    \item عملکرد: بازیابی داده‌ها با فیلترهای اختیاری
    \item احراز هویت: الزامی
    \item پارامترها: \lr{technology, start, end, client\_id, page, page\_size}
\end{itemize}

\paragraph{جریان اتفاقات کد در \lr{GET}}
\begin{enumerate}
    \item خواندن پارامترهای فیلتر از \lr{URL}
    \item انتخاب مدل و \lr{Serializer} مناسب بر اساس تکنولوژی
    \item اعمال محدودیت دسترسی:
    \begin{itemize}
        \item کاربران عادی $\leftarrow$ فقط داده‌های خودشان
        \item ادمین $\leftarrow$ همه داده‌ها، با امکان فیلتر \lr{client\_id}
    \end{itemize}
    \item اعمال فیلتر زمانی (\lr{start} و \lr{end})
    \item صفحه‌بندی داده‌ها (\lr{Pagination})
    \item سریالایز کردن داده‌ها و برگرداندن \lr{Response}
    \item مدیریت خطا در صورت عدم تعیین یا نادرست بودن \lr{technology}
\end{enumerate}

\paragraph{مثال \lr{GET} کاربر}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /cellinfo/signal/?technology=LTE&page=1&page_size=2
\end{lstlisting}
\begin{lstlisting}[style=jsonstyle]
{
  "count": 5,
  "num_pages": 3,
  "current_page": 1,
  "results": [
    {"id": 1, "user": 2, "technology": "LTE", ...},
    {"id": 2, "user": 2, "technology": "LTE", ...}
  ]
}
\end{lstlisting}
\end{latin}

\paragraph{مثال \lr{GET} ادمین با \lr{client\_id}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /cellinfo/signal/?technology=LTE&client_id=2&page=1
\end{lstlisting}
\end{latin}
\begin{itemize}
    \item ادمین می‌تواند داده همه کاربران را ببیند
    \item با \lr{client\_id} فقط داده کاربر مشخص شده را می‌گیرد
\end{itemize}

\paragraph{\lr{Response Fail 400}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{"error": "Missing or invalid technology"}
\end{lstlisting}
\end{latin}

\chapter{\lr{Tests API}}
\lr{Tests API} برای ثبت و بازیابی تست‌های شبکه کاربران طراحی شده است. تست‌ها شامل:
\begin{itemize}
    \item \lr{PingTest}: زمان پاسخ \lr{Ping}
    \item \lr{DNSTest}: زمان پاسخ \lr{DNS}
    \item \lr{WebResponseTest}: زمان پاسخ وب
    \item \lr{HTTPUploadTest / HTTPDownloadTest}: سرعت آپلود و دانلود \lr{HTTP}
    \item \lr{SMSTest}: زمان ارسال و دریافت پیامک
\end{itemize}

\section{ویژگی‌ها}
\begin{itemize}
    \item احراز هویت: تمام ویوها \lr{IsAuthenticated} هستند
    \item کاربران عادی: فقط داده‌های خودشان را می‌بینند
    \item ادمین: می‌تواند داده همه کاربران را مشاهده کند و با \lr{client\_id} فیلتر کند
    \item فیلترها: \lr{start, end, client\_id, page, page\_size}
    \item \lr{Pagination}: نتایج صفحه‌بندی شده و شامل تعداد کل، تعداد صفحات، صفحه جاری و لیست نتایج
\end{itemize}

\section{مدل‌ها}
\subsection{\lr{PingTest}}
\begin{itemize}
    \item \lr{user}: کاربری که تست را ثبت کرده
    \item \lr{timestamp}: زمان انجام تست
    \item \lr{ping\_response\_time}: زمان پاسخ \lr{Ping} به میلی‌ثانیه
\end{itemize}

\subsection{\lr{DNSTest}}
\begin{itemize}
    \item مشابه \lr{PingTest}
    \item \lr{dns\_response\_time}: زمان پاسخ \lr{DNS} به میلی‌ثانیه
\end{itemize}

\subsection{\lr{WebResponseTest}}
\begin{itemize}
    \item \lr{user}: کاربر ثبت‌کننده
    \item \lr{timestamp}: زمان انجام تست
    \item \lr{web\_response\_time}: زمان پاسخ وب به میلی‌ثانیه
\end{itemize}

\subsection{\lr{HTTPUploadTest / HTTPDownloadTest}}
\begin{itemize}
    \item \lr{user}: کاربر ثبت‌کننده
    \item \lr{timestamp}: زمان انجام تست
    \item \lr{upload\_rate / download\_rate}: سرعت آپلود یا دانلود به \lr{Mbps}
\end{itemize}

\subsection{\lr{SMSTest}}
\begin{itemize}
    \item \lr{user}: کاربر ثبت‌کننده
    \item \lr{timestamp\_sent}: زمان ارسال پیامک
    \item \lr{timestamp\_delivery}: زمان دریافت پیامک
    \item \lr{delivery\_duration}: مدت زمان تحویل پیامک به ثانیه
    \item \lr{message\_content}: متن پیامک
\end{itemize}

\section{Serializerها}
\begin{itemize}
    \item همه \lr{Serializer}ها:
    \begin{itemize}
        \item فیلد \lr{user} فقط خواندنی است
        \item اعتبارسنجی داده‌های ورودی برای \lr{POST}
    \end{itemize}
    \item نام \lr{Serializer}ها: \lr{PingTestSerializer, DNSTestSerializer, WebResponseTestSerializer, HTTPUploadTestSerializer, HTTPDownloadTestSerializer, SMSTestSerializer}
\end{itemize}

\section{View}
تمام ویوهای \lr{GET} از \lr{FilteredListMixin} استفاده می‌کنند.
\begin{itemize}
    \item این \lr{Mixin} مسئول فیلتر کردن \lr{QuerySet}، صفحه‌بندی و سریالایز داده‌ها است.
    \item مزیت: کد ویو تمیزتر و مشترک بین تمام تست‌ها می‌شود و مدیریت فیلترها یکجا انجام می‌شود.
\end{itemize}

\subsection{\lr{POST}}
\begin{itemize}
    \item ثبت رکورد جدید تست
    \item جریان کد:
    \begin{enumerate}
        \item دریافت \lr{JSON} ورودی
        \item سریالایز داده‌ها و اعتبارسنجی
        \item ذخیره داده‌ها و اختصاص \lr{user} به کاربر جاری
        \item \lr{Response} موفق (\lr{201 Created}) یا خطا (\lr{400 Bad Request})
    \end{enumerate}
\end{itemize}

\subsection{\lr{GET}}
\begin{itemize}
    \item بازیابی داده‌ها با فیلتر اختیاری
    \item جریان کد (داخل \lr{FilteredListMixin}):
    \begin{enumerate}
        \item خواندن پارامترهای \lr{URL}: \lr{start, end, client\_id, page, page\_size}
        \item اعمال محدودیت دسترسی:
        \begin{itemize}
            \item کاربران عادی $\leftarrow$ فقط داده‌های خود
            \item ادمین $\leftarrow$ همه داده‌ها، امکان فیلتر \lr{client\_id}
        \end{itemize}
        \item فیلتر زمانی (\lr{timestamp} یا \lr{timestamp\_sent} برای \lr{SMS})
        \item صفحه‌بندی داده‌ها
        \item سریالایز و بازگشت \lr{Response}
    \end{enumerate}
\end{itemize}

\section{نمونه‌ها (ورودی و خروجی)}
\subsection{\lr{PingTest}}
\subsubsection{\lr{POST}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "timestamp": "2025-08-21T12:00:00Z",
  "ping_response_time": 25.3
}
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "id": 1,
  "user": 2,
  "timestamp": "2025-08-21T12:00:00Z",
  "ping_response_time": 25.3
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{GET}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /tests/ping/?start=2025-08-21T00:00:00Z&end=2025-08-21T23:59:59Z&page=1&page_size=10
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 200}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "count": 25,
  "num_pages": 3,
  "current_page": 1,
  "results": [
    {"id": 1, "user": 2, "timestamp": "2025-08-21T12:00:00Z", "ping_response_time": 25.3}
  ]
}
\end{lstlisting}
\end{latin}

\subsection{\lr{DNSTest}}
\subsubsection{\lr{POST}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "timestamp": "2025-08-21T12:00:00Z",
  "dns_response_time": 50.2
}
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "id": 1,
  "user": 2,
  "timestamp": "2025-08-21T12:00:00Z",
  "dns_response_time": 50.2
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{GET}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /tests/dns/?start=2025-08-21T00:00:00Z&end=2025-08-21T23:59:59Z
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 200}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "count": 10,
  "num_pages": 1,
  "current_page": 1,
  "results": [
    {"id": 1, "user": 2, "timestamp": "2025-08-21T12:00:00Z", "dns_response_time": 50.2}
  ]
}
\end{lstlisting}
\end{latin}

\subsection{\lr{WebResponseTest}}
\subsubsection{\lr{POST}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "timestamp": "2025-08-21T12:00:00Z",
  "web_response_time": 120.5
}
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "id": 1,
  "user": 2,
  "timestamp": "2025-08-21T12:00:00Z",
  "web_response_time": 120.5
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{GET}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /tests/web/?start=2025-08-21T00:00:00Z&end=2025-08-21T23:59:59Z
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 200}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "count": 8,
  "num_pages": 1,
  "current_page": 1,
  "results": [
    {"id": 1, "user": 2, "timestamp": "2025-08-21T12:00:00Z", "web_response_time": 120.5}
  ]
}
\end{lstlisting}
\end{latin}

\subsection{\lr{HTTPUploadTest}}
\subsubsection{\lr{POST}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "timestamp": "2025-08-21T12:00:00Z",
  "upload_rate": 15.6
}
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "id": 1,
  "user": 2,
  "timestamp": "2025-08-21T12:00:00Z",
  "upload_rate": 15.6
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{GET}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /tests/http-upload/?start=2025-08-21T00:00:00Z&end=2025-08-21T23:59:59Z
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 200}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "count": 12,
  "num_pages": 1,
  "current_page": 1,
  "results": [
    {"id": 1, "user": 2, "timestamp": "2025-08-21T12:00:00Z", "upload_rate": 15.6}
  ]
}
\end{lstlisting}
\end{latin}

\subsection{\lr{HTTPDownloadTest}}
\subsubsection{\lr{POST}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "timestamp": "2025-08-21T12:00:00Z",
  "download_rate": 25.8
}
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "id": 1,
  "user": 2,
  "timestamp": "2025-08-21T12:00:00Z",
  "download_rate": 25.8
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{GET}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /tests/http-download/?start=2025-08-21T00:00:00Z&end=2025-08-21T23:59:59Z
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 200}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "count": 15,
  "num_pages": 2,
  "current_page": 1,
  "results": [
    {"id": 1, "user": 2, "timestamp": "2025-08-21T12:00:00Z", "download_rate": 25.8}
  ]
}
\end{lstlisting}
\end{latin}

\subsection{\lr{SMSTest}}
\subsubsection{\lr{POST}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "timestamp_sent": "2025-08-21T12:00:00Z",
  "timestamp_delivery": "2025-08-21T12:00:05Z",
  "delivery_duration": 5,
  "message_content": "Hello World"
}
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "id": 1,
  "user": 2,
  "timestamp_sent": "2025-08-21T12:00:00Z",
  "timestamp_delivery": "2025-08-21T12:00:05Z",
  "delivery_duration": 5,
  "message_content": "Hello World"
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{GET}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /tests/sms/?start=2025-08-21T00:00:00Z&end=2025-08-21T23:59:59Z
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 200}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "count": 7,
  "num_pages": 1,
  "current_page": 1,
  "results": [
    {
      "id": 1,
      "user": 2,
      "timestamp_sent": "2025-08-21T12:00:00Z",
      "timestamp_delivery": "2025-08-21T12:00:05Z",
      "delivery_duration": 5,
      "message_content": "Hello World"
    }
  ]
}
\end{lstlisting}
\end{latin}

\chapter{\lr{Threshold API}}
\lr{Threshold API} برای مدیریت پارامترها و سطح‌های آستانه (\lr{Threshold}) شبکه طراحی شده است. این آستانه‌ها به کاربر و ادمین اجازه می‌دهند تا کیفیت و کمیت سیگنال شبکه (\lr{2G/3G/4G/5G}) را بررسی کنند و سطوح رنگ‌بندی شده برای هشدار یا نمایش وضعیت تنظیم کنند.

\section{ویژگی‌ها}
\begin{itemize}
    \item احراز هویت: تمام ویوها \lr{IsAuthenticated} هستند
    \item کاربران عادی: فقط پارامترهای خودشان را مشاهده و ویرایش می‌کنند
    \item ادمین: می‌تواند داده همه کاربران را مشاهده کند و با \lr{client\_id} فیلتر کند
    \item \lr{POST}: ایجاد یا آپدیت پارامترهای \lr{Threshold} همراه با سطوح آن
    \item \lr{GET}: لیست پارامترها و سطوح آنها با امکان فیلتر
\end{itemize}

\section{مدل‌ها}
\subsection{\lr{ThresholdParameter}}
\begin{itemize}
    \item \lr{user}: کاربری که این پارامتر را تنظیم کرده
    \item \lr{name}: نام پارامتر (مثلاً \lr{"Signal Strength"})
    \item \lr{technology}: نوع شبکه (\lr{2G/3G/4G/5G})
    \item \lr{signal\_type}: نوع سیگنال (\lr{quantity} یا \lr{quality})
    \item \lr{Relationship}: هر پارامتر می‌تواند چند \lr{ThresholdLevel} داشته باشد
\end{itemize}

\subsection{\lr{ThresholdLevel}}
\begin{itemize}
    \item \lr{parameter}: پارامتر مربوطه
    \item \lr{level}: شماره سطح (مثلاً 1، 2، 3)
    \item \lr{color}: رنگ مربوط به سطح (مثلاً \lr{"green"})
    \item \lr{min\_value}: حداقل مقدار این سطح
    \item \lr{max\_value}: حداکثر مقدار این سطح
\end{itemize}

\section{Serializerها}
\subsection{\lr{Input Serializer}ها}
\begin{itemize}
    \item \lr{ThresholdLevelInputSerializer}: برای هر سطح
    \item \lr{ThresholdParamInputSerializer}: شامل نام، نوع سیگنال و لیست سطوح
    \item \lr{UnifiedThresholdInputSerializer}: شامل تکنولوژی و پارامترهای \lr{Threshold}
\end{itemize}

\subsection{\lr{Output Serializer}ها}
\begin{itemize}
    \item \lr{ThresholdLevelSerializer}: برای نمایش سطح
    \item \lr{ThresholdParameterSerializer}: نمایش پارامتر و لیست سطوح مرتبط
\end{itemize}

\section{View}
\subsection{\lr{ThresholdCreateView (POST)}}
\begin{itemize}
    \item ثبت یا آپدیت پارامترهای \lr{Threshold}
    \item جریان کد:
    \begin{enumerate}
        \item دریافت \lr{JSON} ورودی با تکنولوژی و پارامترها
        \item اعتبارسنجی ورودی
        \item بررسی حداقل ۳ سطح برای هر پارامتر
        \item اگر پارامتر قبلاً وجود داشته باشد $\leftarrow$ حذف سطوح قدیمی
        \item ایجاد یا آپدیت سطح‌ها (\lr{ThresholdLevel})
        \item \lr{Response} موفق (\lr{201 Created}) یا خطا (\lr{400 Bad Request})
    \end{enumerate}
\end{itemize}

\subsubsection{\lr{POST} ورودی نمونه}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "technology": "4G",
  "parameters": [
    {
      "name": "Signal Strength",
      "signal_type": "quantity",
      "levels": [
        {"level": 1, "color": "red", "min": 0, "max": 30},
        {"level": 2, "color": "yellow", "min": 30, "max": 70},
        {"level": 3, "color": "green", "min": 70, "max": 100}
      ]
    }
  ]
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{Response Success 201}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "message": "Thresholds created/updated successfully."
}
\end{lstlisting}
\end{latin}

\subsubsection{\lr{Response Fail 400} (سطح کمتر از ۳)}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
{
  "error": "Parameter 'Signal Strength' must have at least 3 levels."
}
\end{lstlisting}
\end{latin}

\subsection{\lr{ThresholdListView (GET)}}
\begin{itemize}
    \item نمایش پارامترهای \lr{Threshold} و سطوح آن‌ها
    \item فیلترها: \lr{technology, name, client\_id}
    \item کاربران عادی: فقط پارامترهای خودشان
    \item ادمین: می‌تواند همه پارامترها را ببیند و با \lr{client\_id} فیلتر کند
    \item \lr{Pagination} در این ویو پیش‌فرض استفاده نشده، ولی می‌توان اضافه کرد
\end{itemize}

\subsubsection{\lr{GET} نمونه}
\begin{latin}
\begin{lstlisting}[style=jsonstyle, language=bash]
GET /thresholds/?technology=4G&name=Signal%20Strength
\end{lstlisting}
\end{latin}
\textbf{\lr{Response Success 200}}
\begin{latin}
\begin{lstlisting}[style=jsonstyle]
[
  {
    "user_id": 2,
    "name": "Signal Strength",
    "technology": "4G",
    "signal_type": "quantity",
    "levels": [
      {"level": 1, "color": "red", "min_value": 0, "max_value": 30},
      {"level": 2, "color": "yellow", "min_value": 30, "max_value": 70},
      {"level": 3, "color": "green", "min_value": 70, "max_value": 100}
    ]
  }
]
\end{lstlisting}
\end{latin}





\chapter{ \lr{Polaris Client}}

\section{ \lr{Web Application}}

\section{ \lr{Android Mobile Client}}

\chapter{تحلیل و نتجه گیری}
 
\end{document}



